<!-- Kanban Card -->
<div class="kanban-card"
     data-task-id="{{ task.id }}"
     id="kanban-card-{{ task.id }}">

    <!-- Priority indicator -->
    <div class="border-l-4
                {% if task.priority == 'critical' %}border-red-500{% endif %}
                {% if task.priority == 'high' %}border-orange-500{% endif %}
                {% if task.priority == 'medium' %}border-blue-500{% endif %}
                {% if task.priority == 'low' %}border-gray-400{% endif %}">

        <!-- Card header -->
        <div class="flex items-start justify-between mb-2">
            <span class="text-xs font-medium text-blue-600">{{ task.course }}</span>
            {% if task.is_blocked %}
                <span class="text-xs" title="Blocked by: {{ task.blocker_titles|join(', ') }}">🔒</span>
            {% endif %}
        </div>

        <!-- Task title -->
        <h4 class="font-medium text-gray-900 mb-2 text-sm">{{ task.title }}</h4>

        <!-- Metadata -->
        <div class="flex flex-wrap gap-1 mb-2">
            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-600">
                {{ task.category }}
            </span>
            {% if task.assignee %}
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs bg-purple-100 text-purple-700">
                    @{{ task.assignee }}
                </span>
            {% endif %}
        </div>

        <!-- Due date and weight -->
        <div class="flex items-center justify-between text-xs text-gray-500">
            {% if task.due_date %}
                <span class="{% if task.is_overdue %}text-red-600 font-semibold{% endif %}">
                    📅 {{ task.due_date|dateformat('%b %d') }}
                </span>
            {% else %}
                <span></span>
            {% endif %}

            {% if task.weight > 1 %}
                <span title="Weight: {{ task.weight }} points">⚖️ {{ task.weight }}</span>
            {% endif %}
        </div>

        <!-- Dependencies indicator -->
        {% if task.depends_on|length > 0 or task.children|length > 0 %}
            <div class="mt-2 pt-2 border-t border-gray-100 flex gap-2 text-xs text-gray-500">
                {% if task.depends_on|length > 0 %}
                    <span title="{{ task.depends_on|length }} dependencies">
                        ← {{ task.depends_on|length }}
                    </span>
                {% endif %}
                {% if task.children|length > 0 %}
                    <span title="{{ task.children|length }} subtasks">
                        ↓ {{ task.children|length }}
                    </span>
                {% endif %}
            </div>
        {% endif %}

        <!-- Quick actions -->
        <div class="mt-3 flex justify-end gap-2">
            {% if task.status != 'done' and not task.is_blocked %}
                <button class="text-green-600 hover:text-green-800 text-sm"
                        hx-post="/api/tasks/{{ task.id }}/complete"
                        hx-target="#task-container"
                        hx-swap="innerHTML"
                        title="Complete">
                    ✓
                </button>
            {% endif %}

            <button class="text-blue-600 hover:text-blue-800 text-sm"
                    hx-get="/api/tasks/{{ task.id }}/edit-modal"
                    hx-target="#modal-container"
                    hx-trigger="click"
                    title="Edit">
                ✏️
            </button>
        </div>
    </div>
</div>
