# Claude Code Orchestration Triggers

## Automatic Agent Coordination Based on File Changes and Events

## Configuration Date: August 24, 2025

---

## ðŸ”„ Automatic Trigger System

This configuration enables Claude Code's Task tool to automatically invoke specialized agents based on file changes, events, and system conditions.

---

## ðŸ“ File-Based Trigger Patterns

### Course Content Triggers

```yaml
file_patterns:
  "content/courses/**/*.json":
    primary_agent: "course-content"
    secondary_agents: ["qa-validator"]
    automatic_actions:
      - validate_json_schema
      - rebuild_affected_materials
      - verify_rsi_compliance
      - update_course_packages

    trigger_conditions:
      - on_file_save
      - on_git_commit
      - on_pr_creation

    escalation_rules:
      - validation_failure: "halt_pipeline"
      - rsi_missing: "critical_alert"
      - schema_error: "auto_fix_attempt"

  "content/courses/*/due_dates.json":
    primary_agent: "calendar-sync"
    cascade_agents: ["course-content", "qa-validator"]
    automatic_actions:
      - propagate_date_changes
      - check_date_conflicts
      - update_affected_schedules
      - validate_platform_constraints

    trigger_conditions:
      - on_date_modification
      - on_holiday_adjustment
      - on_semester_change

    validation_rules:
      - math221_friday_pattern: "enforce"
      - math251_complex_schedule: "validate"
      - stat253_r_assignment_timing: "verify"
```

### System Configuration Triggers

```yaml
file_patterns:
  "variables/semester.json":
    primary_agent: "calendar-sync"
    cascade_sequence: ["course-content", "qa-validator", "deploy-manager"]
    automatic_actions:
      - update_master_calendar
      - propagate_to_all_courses
      - rebuild_all_schedules
      - validate_system_consistency

    trigger_conditions:
      - semester_dates_change
      - holiday_schedule_update
      - institutional_calendar_sync

    impact_assessment:
      - affected_courses: "all"
      - rebuild_scope: "complete"
      - deployment_required: "yes"

  "templates/**/*.j2":
    primary_agent: "course-content"
    secondary_agents: ["qa-validator", "docs-keeper"]
    automatic_actions:
      - rebuild_affected_outputs
      - validate_template_syntax
      - test_rendering_integrity
      - update_documentation

    trigger_conditions:
      - template_modification
      - new_template_creation
      - template_deletion

    safety_checks:
      - backup_before_change: "yes"
      - test_render_all_courses: "yes"
      - validate_html_output: "yes"
```

### Deployment and CI/CD Triggers

```yaml
file_patterns:
  ".github/workflows/**/*.yml":
    primary_agent: "deploy-manager"
    secondary_agents: ["docs-keeper"]
    automatic_actions:
      - validate_workflow_syntax
      - test_deployment_pipeline
      - check_secrets_availability
      - update_deployment_docs

    trigger_conditions:
      - workflow_modification
      - new_deployment_stage
      - secrets_rotation

    verification_steps:
      - syntax_validation: "github_actions_lint"
      - secret_availability: "cloudflare_token_check"
      - deployment_test: "preview_environment"

  "pyproject.toml":
    primary_agent: "qa-validator"
    cascade_agents: ["deploy-manager", "docs-keeper"]
    automatic_actions:
      - validate_dependencies
      - check_version_compatibility
      - update_lock_files
      - rebuild_documentation

    trigger_conditions:
      - dependency_change
      - version_update
      - configuration_modification
```

---

## âš¡ Event-Based Triggers

### Git Event Triggers

```yaml
git_events:
  on_commit:
    trigger_condition: "files_modified"
    agents_sequence:
      1. "qa-validator" â†’ validate_changed_files
      2. "course-content" â†’ rebuild_if_needed
      3. "deploy-manager" â†’ update_preview

    auto_todo_creation:
      threshold: 3  # Create TodoWrite list for 3+ files changed
      template: "git_commit_workflow"

  on_push_to_main:
    trigger_condition: "production_deployment_ready"
    agents_sequence:
      1. "qa-validator" â†’ full_system_validation
      2. "deploy-manager" â†’ production_deployment
      3. "docs-keeper" â†’ update_deployment_log

    safety_gates:
      - all_tests_pass: "required"
      - no_validation_errors: "required"
      - manual_approval: "for_major_changes"

  on_pr_creation:
    trigger_condition: "collaboration_review_needed"
    agents_sequence:
      1. "qa-validator" â†’ pr_validation_check
      2. "deploy-manager" â†’ create_preview_deployment
      3. "docs-keeper" â†’ update_pr_documentation
```

### System Event Triggers

```yaml
system_events:
  validation_failure:
    trigger_condition: "critical_error_detected"
    immediate_actions:
      - halt_pipeline: "yes"
      - create_incident_todo: "yes"
      - notify_agents: ["qa-validator", "docs-keeper"]

    escalation_sequence:
      1. "qa-validator" â†’ assess_damage_scope
      2. "course-content" â†’ attempt_auto_fix
      3. "deploy-manager" â†’ rollback_if_needed
      4. "docs-keeper" â†’ document_incident

  deadline_approaching:
    trigger_condition: "48_hours_before_due_date"
    automatic_actions:
      - verify_materials_ready: "calendar-sync"
      - validate_platform_sync: "qa-validator"
      - confirm_deployment_status: "deploy-manager"

    alert_sequence:
      - check_material_completeness
      - verify_no_blocking_issues
      - confirm_platform_availability

  external_dependency_failure:
    trigger_condition: "third_party_service_down"
    response_actions:
      - assess_impact: "qa-validator"
      - implement_fallback: "course-content"
      - update_status: "docs-keeper"
```

---

## ðŸ”— Agent Dependency Chains

### Sequential Execution Chains

```yaml
workflow_chains:
  semester_preparation:
    sequence:
      1. "calendar-sync" â†’ generate_master_calendar
         success_triggers: ["course-content"]
         failure_actions: ["halt_workflow", "create_incident"]

      2. "course-content" â†’ build_all_materials
         depends_on: ["calendar-sync_success"]
         success_triggers: ["qa-validator"]
         parallel_allowed: "per_course"

      3. "qa-validator" â†’ comprehensive_validation
         depends_on: ["course-content_success"]
         success_triggers: ["deploy-manager"]
         failure_actions: ["rollback_to_course-content"]

      4. "deploy-manager" â†’ production_deployment
         depends_on: ["qa-validator_success"]
         success_triggers: ["docs-keeper"]
         rollback_on_failure: "yes"

      5. "docs-keeper" â†’ update_all_documentation
         depends_on: ["deploy-manager_success"]
         final_step: "yes"

  content_update_workflow:
    sequence:
      1. "qa-validator" â†’ validate_source_changes
      2. "course-content" â†’ rebuild_affected_materials
      3. "calendar-sync" â†’ check_date_consistency
      4. "deploy-manager" â†’ deploy_to_preview
      5. "docs-keeper" â†’ update_change_log

    parallel_execution:
      - steps_2_and_3: "allowed"  # content rebuild and calendar check
      - step_5: "background"  # documentation update

  emergency_response:
    sequence:
      1. "qa-validator" â†’ assess_critical_damage
         timeout: 60_seconds
         escalate_on_timeout: "manual_intervention"

      2. "deploy-manager" â†’ emergency_rollback
         parallel_with: ["course-content_emergency_fix"]
         max_execution_time: 300_seconds

      3. "course-content" â†’ implement_emergency_fixes
         depends_on: ["qa-validator_assessment"]
         parallel_with: ["deploy-manager_rollback"]

      4. "calendar-sync" â†’ verify_calendar_integrity
         depends_on: ["content-fixes_complete"]

      5. "docs-keeper" â†’ document_incident
         background_execution: "yes"
```

### Parallel Execution Patterns

```yaml
parallel_workflows:
  independent_course_updates:
    agents:
      - "course-content" â†’ math221_update
      - "course-content" â†’ math251_update
      - "course-content" â†’ stat253_update

    coordination_agent: "qa-validator"
    merge_point: "comprehensive_validation"

  documentation_and_deployment:
    parallel_agents:
      - "docs-keeper" â†’ update_documentation
      - "deploy-manager" â†’ prepare_deployment_package

    synchronization_point: "pre_deployment_validation"
    coordination_agent: "qa-validator"

  multi_platform_validation:
    parallel_validation:
      - "qa-validator" â†’ blackboard_ultra_validation
      - "qa-validator" â†’ myopenmath_validation
      - "qa-validator" â†’ edfinity_validation
      - "qa-validator" â†’ pearson_mylab_validation

    coordination_method: "wait_for_all_complete"
    failure_handling: "continue_with_warnings"
```

---

## ðŸŽ¯ Smart Trigger Conditions

### Contextual Decision Making

```yaml
intelligent_triggers:
  file_change_analysis:
    minor_changes:
      criteria: "single_file, non_critical_content"
      agent: "course-content"
      workflow: "simple_rebuild"
      todo_creation: "no"

    moderate_changes:
      criteria: "multiple_files, date_changes, template_updates"
      agents: ["course-content", "qa-validator"]
      workflow: "validation_then_rebuild"
      todo_creation: "yes"

    major_changes:
      criteria: "structural_changes, semester_updates, platform_changes"
      agents: "all"
      workflow: "full_orchestration"
      todo_creation: "detailed"
      manual_approval: "recommended"

  error_pattern_recognition:
    recurring_validation_errors:
      pattern: "same_error_3_times_in_24h"
      action: "create_dedicated_fix_todo"
      agent: "qa-validator"
      escalation: "docs-keeper_for_knowledge_base"

    deployment_failures:
      pattern: "deployment_failure_2_consecutive"
      action: "halt_auto_deployment"
      agent: "deploy-manager"
      escalation: "manual_investigation_required"

    calendar_conflicts:
      pattern: "date_conflict_detected"
      action: "immediate_calendar_sync_review"
      agent: "calendar-sync"
      blocking: "yes"
```

### Load-Based Triggering

```yaml
resource_management:
  agent_workload_balancing:
    high_load_conditions:
      - active_tasks_per_agent: "> 3"
      - system_cpu_usage: "> 80%"
      - concurrent_validations: "> 2"

    load_balancing_actions:
      - queue_non_critical_tasks
      - prioritize_critical_path_tasks
      - enable_parallel_execution_where_safe

  task_prioritization:
    critical_priority:
      - validation_failures
      - deployment_issues
      - calendar_conflicts
      - rsi_compliance_errors

    high_priority:
      - content_generation_requests
      - scheduled_deployments
      - documentation_updates

    normal_priority:
      - routine_validations
      - background_sync_operations
      - performance_optimizations
```

---

## ðŸ“Š Monitoring and Learning

### Trigger Performance Metrics

```yaml
monitoring:
  trigger_accuracy:
    - false_positive_rate: "< 5%"
    - missed_trigger_rate: "< 2%"
    - average_response_time: "< 30s"
    - workflow_completion_rate: "> 95%"

  agent_coordination:
    - sequential_workflow_success: "> 98%"
    - parallel_execution_conflicts: "< 1%"
    - dependency_resolution_accuracy: "> 99%"
    - resource_utilization_efficiency: "> 85%"

learning_patterns:
  trigger_optimization:
    - analyze_frequent_trigger_combinations
    - optimize_agent_sequence_for_efficiency
    - reduce_redundant_validation_steps
    - improve_parallel_execution_opportunities

  failure_pattern_analysis:
    - identify_common_failure_sequences
    - create_preventive_trigger_conditions
    - improve_error_recovery_automation
    - enhance_rollback_trigger_accuracy
```

---

*This trigger system enables intelligent, automatic coordination of Claude Code's specialized agents based on file changes, system events, and contextual conditions, ensuring seamless semester management automation.*
